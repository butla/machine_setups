---
# TODO need dropbox repo for artful - doesn't exist yet
#- name: add dropbox repository
#  become: true
#  apt_repository: repo='deb http://linux.dropbox.com/ubuntu xenial main'
#
#- name: add dropbox package key
#  become: true
#  apt_key: keyserver=pgp.mit.edu id=5044912E

- name: install python-gpgme for dropbox bootstrap
  become: true
  apt: name=python-gpgme

# TODO no dropbox yet
# TODO get rid of unauthorized deb workaround when they fix it
#- name: install dropbox
#  apt: name=dropbox update_cache=yes
#  become: true
#- name: install dropbox
#  become: true
#  command: apt-get install -y --allow-unauthenticated dropbox
#  register: dropbox_install
#  changed_when: dropbox_install.stdout.find('is already the newest') == -1

- name: start and install dropbox daemon
  command: dropbox start -i
  register: dropbox_start
  changed_when: dropbox_start.stdout.find('is already running!') == -1

- name: add inkscape repository
  become: true
  apt_repository: repo=ppa:inkscape.dev/stable

- name: install additional programs
  become: true
  apt: name={{ item }} update_cache=yes cache_valid_time=3600
  with_items:
  - alacritty # nice, fast terminal
  - cheese # taking photos
  - chromium-browser
  - clementine
  - gimp
  - gthumb
  - gparted
  - hplip  # HP printer/scanner drivers
  - inkscape
  # user needs to log in with Dropbox before running keepass
  - keepass2
  - meld  # visual git merge tool
  - pdfmod  # for editing PDFs
  - simple-scan  # for scanner usage; backed by SANE
  - synaptic
  - texlive
  - texlive-generic-extra
  - texlive-lang-english
  - texlive-lang-polish
  - texlive-latex-extra
  - vlc
  - xournal  # writing on PDFs
  # notify-send command for showing notifications
  - libnotify-bin

# TODO update and add ignoring if a newer version is already installed
- name: install additional programs from deb packages
  apt:
    deb: https://downloads.slack-edge.com/linux_releases/slack-desktop-2.6.3-amd64.deb

- name: set clementine settings
  ini_file:
    dest: "{{ ansible_env.HOME }}/.config/Clementine/Clementine.conf"
    section: "{{ item.section }}"
    option: "{{ item.option }}"
    value: "{{ item.value }}"
  with_items:
  - { section: Player, option: volume, value: 100 }
  - { section: Player, option: FadeoutEnabled, value: 'false' }
  - { section: Player, option: CrossfadeEnabled, value: 'false' }
  - { section: Player, option: AutoCrossfadeEnabled, value: 'false' }
  - { section: Player, option: NoCrossfadeSameAlbum, value: 'true' }
  - { section: Player, option: FadeoutPauseEnabled, value: 'false' }
  - { section: MainWindow, option: doubleclick_playmode, value: 3 }
  - { section: MainWindow, option: startupbehaviour, value: 2 }

#TODO vlc and meld settings
